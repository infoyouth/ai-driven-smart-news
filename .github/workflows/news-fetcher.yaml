name: AI Driven News ğŸš€

on:
  workflow_dispatch: # Allow manual triggering of the workflow
  schedule: # Run the workflow on a schedule
    - cron: "0 3 * * *" # Runs daily at 3 AM UTC

jobs:
  run_main_script:
    runs-on: ubuntu-24.04
    env:
      GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }} # Set the API key from GitHub Secrets
    steps:
      - name: ğŸš— Checkout Code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: ğŸ Set Up Python Environment
        uses: actions/setup-python@v4
        with:
          python-version: "3.9"

      - name: ğŸ“¦ Install Poetry
        run: |
          echo "ğŸ”„ Installing Poetry..."
          python -m pip install --upgrade pip
          pip install poetry

      - name: ğŸ“¦ Install Dependencies and Project
        run: |
          echo "ğŸ”„ Installing dependencies and project..."
          poetry install

      - name: ğŸ§ª Debug Python Environment
        run: |
          echo "Python executable: $(which python)"
          echo "Python version: $(python --version)"
          echo "Installed packages:"
          python -m pip list

      - name: ğŸ§ª Set PYTHONPATH
        run: |
          export PYTHONPATH="${PYTHONPATH}:$(pwd)"
          echo "PYTHONPATH set to: $PYTHONPATH"

      - name: ğŸ“ Run Main Script
        run: |
          echo "ğŸš€ Running main.py within Poetry environment..."
          poetry run python main.py

      - name: ğŸŒ Beautify Logs
        run: echo "ğŸ‰ Workflow completed successfully! ğŸ‰"